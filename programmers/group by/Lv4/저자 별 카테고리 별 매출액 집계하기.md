```sql
-- Lv.4
-- 저자 별 카테고리 별 매출액 집계하기

SELECT
    a.author_id,
    b.author_name,
    a.category,
    SUM(a.price * c.sum_sales) AS total_sales
FROM book a
JOIN author b ON a.author_id = b.author_id
JOIN (
    SELECT book_id, SUM(sales) as sum_sales
    FROM book_sales
    WHERE sales_date BETWEEN '2022-01-01' AND '2022-01-31'
    GROUP BY book_id
) c ON a.book_id = c.book_id
GROUP BY a.author_id, a.category
ORDER BY a.author_id, a.category DESC;
```
```sql
-- Lv.3
-- 특정 조건을 만족하는 물고기별 수와 최대 길이 구하기

SELECT
    fish_count,
    max_length,
    fish_type
FROM (
    SELECT
        fish_type,
        COUNT(*) AS fish_count,
        AVG(COALESCE(length, 10)) AS avg_length,
        MAX(COALESCE(length, 10)) AS max_length
    FROM fish_info
    GROUP BY fish_type
) a
WHERE avg_length >= 33
ORDER BY fish_type;
```